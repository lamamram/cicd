# image par défaut du pipeline
# image: gitlab.myusine.fr:5050/root/myusine/docker:19
image: $CI_REGISTRY/root/myusine/docker:19

workflow:
  rules:
    - if: $CI_PIPELINE_SOURCE == "push"
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"

stages:
  - builds

build:
  # services réseaux ajoutés à un job (ou au pipeline)
  # les conteneurs sont disponible pour des connections
  # depuis le conteneur du job
  services:
    - name: docker:19-dind
      # hostname du service réseau
      alias: docker
  stage: builds
  script:
    - whoami
    - docker build -t my_tomcat:1.0 .




